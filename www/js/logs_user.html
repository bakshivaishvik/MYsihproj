<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Employee Logs</title>
    <link rel="stylesheet" href="emp.css">
    <link rel="stylesheet" href="addloc.css">
</head>
<body>
<div class="container">
    <h1>Employee Logs</h1>

    <div id="logs">
        <h2>Logs:</h2>
        <table id="logsTable">
            <thead>
            <tr>
                <th>Sno</th>
                <th>ID</th>
                <th>Distance</th>
                <th>Time</th>
                <th>Status</th>
            </tr>
            </thead>
            <tbody>
            <!-- Logs will be inserted here -->
            </tbody>
        </table>
    </div>
</div>

<script>
    // Retrieve IP address from session storage
    const ip_ad = sessionStorage.getItem('ip_ad');

    // Retrieve URL parameters
    const urlParams = new URLSearchParams(window.location.search);
    const employeeId = decodeURIComponent(urlParams.get('userId'));

    // Fetch logs and display them
    async function fetchLogs() {
        try {
            const response = await fetch(`https://${ip_ad}/LogInOut/allemp/${employeeId}`, {
                method: 'GET',
                headers: {
                    'Content-Type': 'application/json'
                }
            });

            if (response.ok) {
                const logs = await response.json();
                displayLogs(logs);
            } else {
                console.error('Error fetching logs:', response.statusText);
                alert('Failed to fetch logs');
            }
        } catch (error) {
            console.error('Network error:', error);
            alert('Network error: ' + error.message);
        }
    }

    // Function to display logs in the table
    function displayLogs(logs) {
        const tableBody = document.querySelector('#logsTable tbody');
        tableBody.innerHTML = ''; // Clear existing content

        logs.forEach(log => {
            const row = document.createElement('tr');
            row.innerHTML = `
                <td>${log.sno}</td>
                <td>${log.id}</td>
                <td>${log.dist}</td>
                <td>${new Date(log.time).toLocaleString()}</td>
                <td>${log.status ? 'In' : 'Out'}</td>
            `;
            tableBody.appendChild(row);
        });
    }

    // Call the fetchLogs function when the page loads
    document.addEventListener('DOMContentLoaded', fetchLogs);
</script>
</body>
</html>
